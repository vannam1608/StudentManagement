<div class="container mt-4">
  <h4>ğŸ“ ÄÄƒng kÃ½ mÃ´n há»c</h4>

  <!-- Dropdown chá»n há»c ká»³ -->
  <div class="row mt-3 mb-3">
    <div class="col-md-4">
      <label for="semesterSelect" class="form-label">ğŸ“ Chá»n há»c ká»³</label>
      <select
        id="semesterSelect"
        class="form-select"
        [(ngModel)]="selectedSemester"
        (change)="loadSubjects()">
        <option [ngValue]="0">-- Táº¥t cáº£ há»c ká»³ --</option>
        <option *ngFor="let sem of semesters" [ngValue]="sem.id">
          {{ sem.name }}
        </option>
      </select>
    </div>
  </div>

  <!-- Danh sÃ¡ch mÃ´n há»c -->
  <div *ngFor="let semester of groupedSubjects | keyvalue">
    <h5 class="mb-3">ğŸ“† {{ semester.key }}</h5>
    <div class="table-responsive">
      <table class="table table-bordered table-striped">
        <thead class="table-light">
          <tr>
            <th>MÃ£ mÃ´n</th>
            <th>TÃªn mÃ´n</th>
            <th>HÃ nh Ä‘á»™ng</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let subject of semester.value">
            <td>{{ subject.subjectCode }}</td>
            <td>{{ subject.name }}</td>
            <td>
              <ng-container *ngIf="isRegistered(subject.id); else notRegistered">
                <button class="btn btn-sm btn-secondary" disabled>ÄÃ£ Ä‘Äƒng kÃ½</button>
              </ng-container>

              <ng-template #notRegistered>
                <ng-container *ngIf="isCurrentSemesterOpen; else closedNotice">
                  <button class="btn btn-sm btn-success" (click)="registerSubject(subject.id)">
                    ÄÄƒng kÃ½
                  </button>
                </ng-container>
              </ng-template>

              <ng-template #closedNotice>
                <span class="text-danger">â›” Há»c ká»³ Ä‘Ã£ Ä‘Ã³ng</span>
              </ng-template>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <!-- MÃ´n há»c Ä‘Ã£ Ä‘Äƒng kÃ½ -->
  <h5 class="mt-5">ğŸ“š Danh sÃ¡ch mÃ´n Ä‘Ã£ Ä‘Äƒng kÃ½</h5>

  <div *ngIf="registeredSubjectIds.length === 0" class="alert alert-info mt-3">
    Báº¡n chÆ°a Ä‘Äƒng kÃ½ mÃ´n há»c nÃ o.
  </div>

  <div *ngFor="let semester of groupedRegisteredSubjects | keyvalue" class="mt-3">
    <h6>{{ semester.key }}</h6>
    <ul class="list-group">
      <li class="list-group-item" *ngFor="let subject of semester.value">
        {{ subject.subjectCode }} - {{ subject.name }}
      </li>
    </ul>
  </div>
</div>
